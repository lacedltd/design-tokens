# Laced Design Tokens

This repo contains the design tokens created in [Figma](https://docs.tokens.studio) which are transformed to CSS & SCSS with token-transformer and [Style Dictionary](https://amzn.github.io/style-dictionary/#/)

Change your tokens in `tokens.json` (either directly or with the Figma Tokens plugin in Figma). The GitHub action will automatically generate style dictionary tokens to `style-dictionary/*` that can then be read by Style Dictionary, which will output tokens to the format you defined in `utils/style-dictionary.js`

### Before Making Change...

Always `git pull` before making changes as it's very likely there are remote changes because of the auto-commit bot configured in the Github Action

### Pre-Requisites

```sh
npm install
```

### Utils

### Transformers + Filters (Style Dictionary)

Some custom transformers and filters have been registered to the build process in order to get working CSS

_Filters_

- `omitTypography` Removes the typography tokens

_Transforms_

- `numberToPx` Convert all number values (except opacity) to `px` as Figma tokens works best with raw number values (allows cross referencing tokens and math i.e. {spacing.sm} * 2)
- `flattenShadow` Check for shadow tokens and convert the object `{ x: 0, y: 0, blur: 0, ...}` to `"0px 0px 0px ..."`
- `fontweightsToNumber` Convert font weight keywords to numbers e.g. Regular -> 400
- `letterSpacingPercentageToEM` converts all percentage-based letter-spacing values to `em` as css doesn't support `%` for this property
- `descriptionToComment` adds a `comment` attribute to each token based on the `description` value coming from Figma Tokens, this allows comments to be generated by Style Dictionary where possible

### Build

```sh
npm run build
```

This is configured to generate various CSS, SCSS, Javascript etc... assets in `dist`.

This script is also used by the Github Action so to make changes to the CI, simply change this file

### Release

The assets in `dist` are published to Github Packages npm registry and is done entirely through Github Actions.

To create a new release:
0. Make sure the build workflow has finished first!
1. Goto the `Actions` tab
2. Choose the `Release` workflow on the left sidebar
3. Click the `Run workflow` button on the right
4. Select the `design` branch and select the desired Semantic Version for the release
5. Click `Run workflow`!

TODO also deploy to S3?

### Usage

In the project you wish to install this package in, add a `.npmrc` file at the root of the project.

Then add the following to that file:

```
//npm.pkg.github.com/:_authToken=ACCESS_TOKEN
@lacedltd:registry=https://npm.pkg.github.com
```

Replacing ACCESS_TOKEN with the Github access token found in the password manager.

`//npm.pkg.github.com/:_authToken=ACCESS_TOKEN` - This line tells npm to authenticate to Github Packages with the provided access token.

`@lacedltd:registry=https://npm.pkg.github.com` - This line tells npm to use the Github Packages npm registry for fetching any packages in the `@lacedltd` scope.

Then, install:

`npm install @lacedltd/design-tokens`
